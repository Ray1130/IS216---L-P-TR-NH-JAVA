<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8">
    <title>ƒêƒÉng k√Ω m√¥n d·∫°y</title>
    <link rel="stylesheet" href="/css/styleDKGD.css">

    <style>
        /* Footer n√∫t x√°c nh·∫≠n */
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #f9f9f9;
            padding: 10px 20px;
            text-align: right;
            border-top: 1px solid #ccc;
            z-index: 10;
        }

        .footer .confirm-btn {
            background: linear-gradient(135deg, #00b4db, #0083b0);
            color: #fff;
            font-size: 16px;
            font-weight: bold;
            border: none;
            padding: 12px 28px;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: background 0.3s ease, transform 0.2s ease;
        }

        .footer .confirm-btn:hover {
            background: linear-gradient(135deg, #0083b0, #005f73);
            transform: scale(1.05);
        }

        /* T√¨m ki·∫øm form */
        /* Thanh t√¨m ki·∫øm ƒë·∫πp h∆°n nha */
        .search-bar {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .search-input input[type="text"] {
            padding: 10px 14px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 14px;
            width: 395px;
        }

        .search-button, .search-btn {
            background-color: #005295;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 14px;
            border-radius: 20px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            text-decoration: none;
        }

        .search-button:hover,
        .search-btn:hover {
            background-color: #003f7f;
        }

        /* Ph·∫ßn sau ƒë√¢y l√† cho thanh k√©o cu·ªôn c·ªßa table ƒëƒÉng k√Ω m√¥n d·∫°y */
        .table-container {
            max-height: 400px; /* üëà Chi·ªÅu cao b·∫£ng hi·ªÉn th·ªã */
            overflow-y: auto;
            border: 1px solid #ccc;
            margin-top: 10px;
        }

        /* Gi·ªØ c·ªë ƒë·ªãnh header khi cu·ªôn */
        .table-container thead th {
            position: sticky;
            top: 0;
            background-color: #f0f0f0;
            z-index: 2;
        }

        /* T√πy ch·ªânh b·∫£ng cho ƒë·∫πp */
        table {
            border-collapse: collapse;
            width: 100%;
        }

        table th, table td {
            padding: 12px 10px;
            border: 1px solid #ddd;
            text-align: left;
        }

        /* new */
            .scrollable-table-wrapper {
        max-height: 350px; /* Chi·ªÅu cao c·ªë ƒë·ªãnh b·∫°n mu·ªën, c√≥ th·ªÉ tƒÉng/gi·∫£m */
        overflow-y: auto; /* Hi·ªÉn th·ªã thanh cu·ªôn d·ªçc khi c·∫ßn */
        //border: 1px solid #ccc; /* Cho khung r√µ r√†ng h∆°n, r√µ d·ªØ r ƒë√≥ x·∫•u vcl */
        border-radius: 8px;
    }

    /* Optional: C·ªë ƒë·ªãnh header b·∫£ng */
    .scrollable-table-wrapper table {
        width: 100%;
        border-collapse: collapse;
    }
    /* khong can cai nay de dinh dang lai dau toi co roi
    .scrollable-table-wrapper thead th {
        position: sticky;
        top: 0;
        background-color: #f2f2f2;
        z-index: 1;
        box-shadow: 0 2px 2px -1px rgba(0,0,0,0.1);
    }
*/
// cho cai checkbox nam giua
        .checkbox-cell {
    text-align: center;
    vertical-align: middle;
    height: 100%; /* ƒë·∫£m b·∫£o td c√≥ chi·ªÅu cao ƒë·ªÉ cƒÉn gi·ªØa */
}
            /* Wrapper cho ph·∫ßn user v√† dropdown */
        .user-dropdown-wrapper {
          margin-left: auto; /* ƒê·∫©y ph·∫ßn user sang ph·∫£i c√πng */
          position: relative; /* C·∫ßn thi·∫øt ƒë·ªÉ ƒë·ªãnh v·ªã dropdown con */
          display: flex; /* Th√™m ƒë·ªÉ cƒÉn ch·ªânh trigger b√™n trong n·∫øu c·∫ßn */
          align-items: center; /* CƒÉn ch·ªânh trigger */
        }

        /* Ph·∫ßn click ƒë·ªÉ m·ªü dropdown */
        .user-info-trigger {
          cursor: pointer;
          display: flex;
          align-items: center;
          padding: 8px 12px;
          border-radius: 4px;
          transition: background-color 0.2s ease-in-out;
          /* N·∫øu b·∫°n mu·ªën n√≥ gi·ªëng user-info, c√≥ th·ªÉ th√™m m·ªôt s·ªë thu·ªôc t√≠nh t·ª´ .user-info */
          font-weight: 500;
          font-size: 16px;
          color: #000;
        }

        .user-info-trigger:hover {
          background-color: #e9ecef; /* M√†u n·ªÅn khi hover */
        }

        .username-display {
          /* font-weight: 500; ƒê√£ c√≥ trong user-info-trigger */
          /* color: #333; ƒê√£ c√≥ trong user-info-trigger */
          margin-right: 8px; /* Kho·∫£ng c√°ch gi·ªØa t√™n v√† icon m≈©i t√™n */
        }

        .user-caret-icon {
          /* color: #555; ƒê√£ c√≥ trong user-info-trigger n·∫øu b·∫°n mu·ªën ƒë·ªìng b·ªô */
          font-size: 0.9em; /* K√≠ch th∆∞·ªõc icon m≈©i t√™n */
          transition: transform 0.2s ease-in-out; /* Hi·ªáu ·ª©ng xoay m≈©i t√™n */
        }
        /* N·ªôi dung dropdown */
        .dropdown-content-simple {
          display: none;      /* QUAN TR·ªåNG: Ph·∫£i ·∫©n ban ƒë·∫ßu */
          position: absolute; /* QUAN TR·ªåNG: ƒê·ªÉ ƒë·ªãnh v·ªã so v·ªõi cha */
          background-color: white;
          min-width: 160px; /* Chi·ªÅu r·ªông t·ªëi thi·ªÉu c·ªßa dropdown */
          box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.15);
          z-index: 1001; /* ƒê·∫£m b·∫£o dropdown n·ªïi l√™n tr√™n menu (menu c√≥ z-index: 1000) */
          right: 0; /* CƒÉn ph·∫£i v·ªõi wrapper */
          top: calc(100% + 5px); /* V·ªã tr√≠ ngay d∆∞·ªõi trigger, c√≥ kho·∫£ng c√°ch 5px */
          border: 1px solid #ddd;
          border-radius: 4px;
          overflow: hidden; /* ƒê·ªÉ bo g√≥c ho·∫°t ƒë·ªông ƒë√∫ng v·ªõi button b√™n trong */
        }

        /* N√∫t ƒëƒÉng xu·∫•t trong dropdown */
        .dropdown-item-simple.logout-button-simple {
          display: block; /* ƒê·ªÉ chi·∫øm to√†n b·ªô chi·ªÅu r·ªông */
          width: 100%;
          padding: 10px 15px;
          text-align: left; /* CƒÉn ch·ªØ sang tr√°i */
          background-color: transparent;
          border: none;
          color: #333;
          font-size: 14px;
          cursor: pointer;
          font-family: inherit; /* K·∫ø th·ª´a font t·ª´ body/nav */
        }

        .dropdown-item-simple.logout-button-simple:hover {
          background-color: #f0f0f0; /* M√†u n·ªÅn khi hover n√∫t */
          color: #0056b3; /* M√†u ch·ªØ khi hover n√∫t */
        }

            /* Wrapper cho ph·∫ßn user v√† dropdown */
        .user-dropdown-wrapper {
          margin-left: auto; /* ƒê·∫©y ph·∫ßn user sang ph·∫£i c√πng */
          position: relative; /* C·∫ßn thi·∫øt ƒë·ªÉ ƒë·ªãnh v·ªã dropdown con */
          display: flex; /* Th√™m ƒë·ªÉ cƒÉn ch·ªânh trigger b√™n trong n·∫øu c·∫ßn */
          align-items: center; /* CƒÉn ch·ªânh trigger */
        }

        /* Ph·∫ßn click ƒë·ªÉ m·ªü dropdown */
        .user-info-trigger {
          cursor: pointer;
          display: flex;
          align-items: center;
          padding: 8px 12px;
          border-radius: 4px;
          transition: background-color 0.2s ease-in-out;
          /* N·∫øu b·∫°n mu·ªën n√≥ gi·ªëng user-info, c√≥ th·ªÉ th√™m m·ªôt s·ªë thu·ªôc t√≠nh t·ª´ .user-info */
          font-weight: 500;
          font-size: 16px;
          color: #000;
        }

        .user-info-trigger:hover {
          background-color: #e9ecef; /* M√†u n·ªÅn khi hover */
        }

        .username-display {
          /* font-weight: 500; ƒê√£ c√≥ trong user-info-trigger */
          /* color: #333; ƒê√£ c√≥ trong user-info-trigger */
          margin-right: 8px; /* Kho·∫£ng c√°ch gi·ªØa t√™n v√† icon m≈©i t√™n */
        }

        .user-caret-icon {
          /* color: #555; ƒê√£ c√≥ trong user-info-trigger n·∫øu b·∫°n mu·ªën ƒë·ªìng b·ªô */
          font-size: 0.9em; /* K√≠ch th∆∞·ªõc icon m≈©i t√™n */
          transition: transform 0.2s ease-in-out; /* Hi·ªáu ·ª©ng xoay m≈©i t√™n */
        }
        /* N·ªôi dung dropdown */
        .dropdown-content-simple {
          display: none;      /* QUAN TR·ªåNG: Ph·∫£i ·∫©n ban ƒë·∫ßu */
          position: absolute; /* QUAN TR·ªåNG: ƒê·ªÉ ƒë·ªãnh v·ªã so v·ªõi cha */
          background-color: white;
          min-width: 160px; /* Chi·ªÅu r·ªông t·ªëi thi·ªÉu c·ªßa dropdown */
          box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.15);
          z-index: 1001; /* ƒê·∫£m b·∫£o dropdown n·ªïi l√™n tr√™n menu (menu c√≥ z-index: 1000) */
          right: 0; /* CƒÉn ph·∫£i v·ªõi wrapper */
          top: calc(100% + 5px); /* V·ªã tr√≠ ngay d∆∞·ªõi trigger, c√≥ kho·∫£ng c√°ch 5px */
          border: 1px solid #ddd;
          border-radius: 4px;
          overflow: hidden; /* ƒê·ªÉ bo g√≥c ho·∫°t ƒë·ªông ƒë√∫ng v·ªõi button b√™n trong */
        }

        /* N√∫t ƒëƒÉng xu·∫•t trong dropdown */
        .dropdown-item-simple.logout-button-simple {
          display: block; /* ƒê·ªÉ chi·∫øm to√†n b·ªô chi·ªÅu r·ªông */
          width: 100%;
          padding: 10px 15px;
          text-align: left; /* CƒÉn ch·ªØ sang tr√°i */
          background-color: transparent;
          border: none;
          color: #333;
          font-size: 14px;
          cursor: pointer;
          font-family: inherit; /* K·∫ø th·ª´a font t·ª´ body/nav */
        }

        .dropdown-item-simple.logout-button-simple:hover {
          background-color: #f0f0f0; /* M√†u n·ªÅn khi hover n√∫t */
          color: #0056b3; /* M√†u ch·ªØ khi hover n√∫t */
        }
    </style>

</head>

<body>

<nav>

    <button class="confirm-btn">
        <a th:href="@{/lecturer/dashboarddkgd}" style="text-decoration: none; color: inherit;">Dashboard</a>
    </button>
    <button class="tab-btn active">
        <a th:href="@{/lecturer/dangkymonday}" style="text-decoration: none; color: inherit;">ƒêƒÉng k√Ω m√¥n d·∫°y</a>
    </button>
    <button class="tab-btn">
        <a th:href="@{/lecturer/dangkylichday}" style="text-decoration: none; color: inherit;">ƒêƒÉng k√Ω l·ªãch d·∫°y</a>
    </button>
    <button class="tab-btn">
        <a th:href="@{/lecturer/danhsachdkgd}" style="text-decoration: none; color: inherit;">Xem m√¥n, l·ªãch ƒë√£ ƒëƒÉng k√Ω</a>
    </button>
    <button class="tab-btn">
        <a th:href="@{/lecturer/danhsachphancong}" style="text-decoration: none; color: inherit;">Danh s√°ch l·ªõp d·∫°y</a>
    </button>

    <div class="user-dropdown-wrapper">
        <!-- Ph·∫ßn k√≠ch ho·∫°t dropdown (T√™n ng∆∞·ªùi d√πng v√† icon m≈©i t√™n) -->
        <div id="userInfoTrigger" class="user-info-trigger">
            <span th:text="${#authentication.name ?: 'Ng∆∞·ªùi d√πng'}" class="username-display">T√™n Ng∆∞·ªùi D√πng</span>
            <i class="fas fa-caret-down user-caret-icon"></i> <!-- Icon m≈©i t√™n xu·ªëng, c·∫ßn Font Awesome -->
        </div>

        <!-- N·ªôi dung Dropdown -->
        <div id="userDropdownContent" class="dropdown-content-simple">
            <form th:action="@{/logout}" method="post" style="margin:0;">
                <button type="submit" class="dropdown-item-simple logout-button-simple">ƒêƒÉng xu·∫•t</button>
            </form>
        </div>
    </div>


</nav>

<div class="container">
    <div th:if="${ketQuaDangKy != null}" style="margin-bottom: 20px;">
        <ul style="list-style: none; padding-left: 0;">
            <li th:each="entry : ${ketQuaDangKy}"
                th:style="${entry.value.toLowerCase().contains('th√†nh c√¥ng')} ? 'margin-bottom:10px; padding:12px; border-radius:8px; background-color:#d4edda; color:#155724; border:1px solid #c3e6cb;'
                 : 'margin-bottom:10px; padding:12px; border-radius:8px; background-color:#f8d7da; color:#721c24; border:1px solid #f5c6cb;'">
                <i th:classappend="${entry.value.toLowerCase().contains('th√†nh c√¥ng')} ? 'fa-solid fa-circle-check' : 'fa-solid fa-circle-xmark'"
                   style="margin-right: 8px;"></i>
                <strong th:text="${entry.key}">M√£ m√¥n h·ªçc</strong>:
                <span th:text="${entry.value}">Th√¥ng b√°o</span>
            </li>
        </ul>
    </div>

    <h1>ƒêƒÉng k√Ω m√¥n d·∫°y</h1>

    <form class="search-bar" method="get" th:action="@{/lecturer/dangkymonday}">

        <div class="search-input">
            <!-- tat ca la tai m, con name="" khien t khong the nao search duoc -->
            <input type="text" name="maMH" placeholder="M√£ m√¥n h·ªçc" th:value="${maMH}">
            <i class="fa fa-search"></i>
        </div>

        <div class="search-input">
            <input type="text" name ="tenMH" placeholder="T√™n m√¥n h·ªçc" th:value="${tenMH}">
            <i class="fa fa-search"></i>
        </div>

        <button type="submit" class="search-btn">T√¨m ki·∫øm</button>
        <a th:href="@{/lecturer/dangkymonday}" class="search-btn" style="background-color: gray; text-decoration: none;">Hi·ªÉn th·ªã t·∫•t c·∫£</a>


    </form>

    <form th:action="@{/lecturer/luuphieudangky}" method="post">

        <div class="scrollable-table-wrapper">
            <!-- <input type="hidden" name="maHK" th:value="${maHK}"/> no need if dont take it from form -->
            <table>
                <thead>
                <tr>
                    <th>M√£ m√¥n h·ªçc</th>
                    <th>T√™n m√¥n h·ªçc</th>
                    <th>S·ªë TC</th>
                    <th>Lo·∫°i m√¥n</th>
                    <th>M√£ Khoa - T√™n Khoa</th>
                    <th>Ch·ªçn</th>
                </tr>
                </thead>

                <!-- V·∫•n ƒë·ªÅ hi·ªán t·∫°i l√† l·ªói 400 Bad Request v√† th√¥ng b√°o thi·∫øu tham s·ªë maHK trong controller.
                Trong HTML b·∫°n v·ª´a g·ª≠i, b·∫°n c√≥ checkbox selectedMon, nh∆∞ng ch∆∞a c√≥ input ch·ª©a maHK,
                v√¨ v·∫≠y khi ng∆∞·ªùi d√πng nh·∫•n submit, tham s·ªë maHK kh√¥ng ƒë∆∞·ª£c g·ª≠i l√™n ‚Üí g√¢y l·ªói. -->
                <tbody>
                <tr th:each="mh : ${monHocList}" th:attr="data-ma-mh=${mh.MaMH}">

                    <td th:text="${mh.MaMH}"></td>
                    <td th:text="${mh.TenMH}" ></td>
                    <td th:text="${mh.SoTinChi}"></td>
                    <td th:text="${mh.LoaiMon}"></td>
                    <td th:text="${mh.MaKhoa + ' - ' + mh.TenKhoa}"></td>
                    <td class="checkbox-cell">
                        <label class="aesthetic-checkbox">
                            <input type="checkbox" name="selectedMon" th:value="${mh.maMH}">
                            <span class="checkmark"></span>
                        </label>
                    </td>
                </tbody>
            </table>
        </div>

        <!-- Footer -->
        <div class="footer">
            <button id="btnXacNhan" class="confirm-btn">X√°c nh·∫≠n</button>
        </div>

    </form>

</div>

<!-- Script ƒë·ªÉ l√†m m·ªù v√† x√≥a th√¥ng b√°o -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        document.querySelectorAll('.alert').forEach(alert => {
          alert.style.transition = 'opacity 0.5s ease';
          alert.style.opacity = '0';
          setTimeout(() => alert.remove(), 500); // X√≥a ho√†n to√†n sau khi m·ªù d·∫ßn
        });
      }, 3000);
    });
            document.addEventListener('DOMContentLoaded', function () {
        const trigger = document.getElementById('userInfoTrigger');
        const dropdownMenu = document.getElementById('userDropdownContent');

        if (trigger && dropdownMenu) {
            trigger.addEventListener('click', function (event) {
                // NgƒÉn s·ª± ki·ªán click lan ra ngo√†i, n·∫øu trigger n·∫±m trong ph·∫ßn t·ª≠ c√≥ th·ªÉ click kh√°c
                event.stopPropagation();
                // Toggle hi·ªÉn th·ªã menu
                dropdownMenu.style.display = dropdownMenu.style.display === 'block' ? 'none' : 'block';
            });

            // ƒê√≥ng menu n·∫øu click ra b·∫•t k·ª≥ ƒë√¢u b√™n ngo√†i menu v√† trigger
            document.addEventListener('click', function (event) {
                if (dropdownMenu.style.display === 'block' && !trigger.contains(event.target) && !dropdownMenu.contains(event.target)) {
                    dropdownMenu.style.display = 'none';
                }
            });
                    // (T√πy ch·ªçn) ƒê√≥ng menu khi nh·∫•n ph√≠m Escape
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape' && dropdownMenu.style.display === 'block') {
                    dropdownMenu.style.display = 'none';
                }
            });
        }
        });
</script>


</body>
</html>